# sudo がなぜホスト名を参照するのか？

`hostnamectl` でホスト名前を変えたら `sudo` にかなりの時間がかかるようになってしまった。  
`/etc/hosts` を更新することで直るのはわかるのだが、`sudo` とホスト名の関係がわからなかった。

以下の理由らしい。  
https://superuser.com/questions/429790/sudo-command-trying-to-search-for-hostname

ChatGPT による翻訳。
> /etc/sudoersファイルは複数のサーバー間で配布できるように設計されています。これを実現するために、ファイル内の各権限にはホスト部分があります。  
> 通常、これはALL=に設定されており、これは権限がどのサーバーでも有効であることを意味しますが、特定のホストに設定することもできます。  
> ```
> %sudo    kaagini=(ALL) ALL
> ```  
> このルールが適用されるべきかどうかをsudoが知るためには、実行されているホストを調査する必要があります。これには/etc/hostsが正しいことを前提とした呼び出しが使われています。そのため、これが正しくない場合には失敗します。
> もし権限のホスト部分が全ての権限に対してALL=に設定されている場合、sudoは名前の検索をする必要がないと主張されるかもしれませんが、それはうまく機能しません。sudoはルールを処理する前に実行されている場所を把握するようです。  
> これは実際にはsudoが現在のマシンでユーザーが何ができるかを確認するためのもので、管理者としては、100台のサーバーがあれば、それぞれのマシンごとに異なる/etc/sudoersファイルを維持する必要があります。sudoersは権限にホスト部分を持っているので、1つのsudoersファイルを維持し、それをすべてのマシンに配布することができ、それでも各マシンでユーザーが何ができるかについて詳細な制御が可能です。
